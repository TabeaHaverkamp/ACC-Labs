#cloud-config

apt_update: true
apt_upgrade: true

packages:
 - python3-pip

byobu_default: system

runcmd:
 - pip3 install celery
 - pip3 install Flask
 - git clone https://github.com/TabeaHaverkamp/ACC-Labs.git /home/ubuntu/
 - cd ACC-Labs && git checkout concurrent
 # todo set master_IP
 #- sudo sed 's/localhost/MASTER_IP/' -i /home/ubuntu/ACC-Labs/Lab3/settings.py

 # mount tweets
 #- sudo mkdir /mnt/tweets
 #- sudo mount /dev/vdb /mnt/tweets/

 #- celery worker -A ~/ACC-Labs/Lab3/tasks --loglevel=INFO -n worker-vm@%h --autoscale=10,3 --without-gossip --max-memory-per-child 100
